<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esports GM: Dynasty Builder</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0a0b10;
            --bg-panel: #14161f;
            --primary: #00f3ff; /* Neon Cyan */
            --secondary: #7000ff; /* Neon Purple */
            --accent: #ff0055; /* Neon Pink */
            --text-main: #ffffff;
            --text-dim: #8892b0;
            --border: #2d3748;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Rajdhani', sans-serif;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* --- Utility & Layout --- */
        .container { max-width: 1000px; margin: 0 auto; padding: 2rem; }
        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Header & HUD --- */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border);
            margin-bottom: 2rem;
        }
        
        .logo { font-size: 2rem; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; }
        .logo span { color: var(--primary); }

        .hud {
            display: flex;
            gap: 1.5rem;
            background: var(--bg-panel);
            padding: 0.5rem 1.5rem;
            border-radius: 4px;
            border: 1px solid var(--border);
        }
        
        .stat { text-align: center; }
        .stat-label { font-size: 0.75rem; color: var(--text-dim); text-transform: uppercase; }
        .stat-value { font-size: 1.25rem; font-weight: 700; font-family: 'Roboto Mono', monospace; }
        .stat-value.high { color: var(--primary); }
        .stat-value.med { color: #ffd700; }
        .stat-value.low { color: var(--accent); }

        /* --- Typography --- */
        h1, h2, h3 { margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 1px; }
        h1 { font-size: 2.5rem; }
        p { color: var(--text-dim); margin-bottom: 1.5rem; max-width: 600px; }

        /* --- Components --- */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .option-card {
            background: var(--bg-panel);
            border: 1px solid var(--border);
            padding: 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .option-card:hover { transform: translateY(-2px); border-color: var(--primary); box-shadow: 0 0 15px rgba(0, 243, 255, 0.1); }
        .option-card.selected { border-color: var(--primary); background: rgba(0, 243, 255, 0.05); }
        .option-card.selected::after {
            content: 'âœ“';
            position: absolute; top: 10px; right: 10px;
            color: var(--primary); font-weight: bold;
        }
        
        .card-title { font-weight: 700; font-size: 1.1rem; margin-bottom: 0.5rem; color: var(--text-main); }
        .card-desc { font-size: 0.9rem; color: var(--text-dim); }
        .card-bonus { font-size: 0.8rem; color: var(--primary); margin-top: 0.5rem; font-family: 'Roboto Mono'; }

        /* --- Controls --- */
        .btn {
            background: var(--primary);
            color: var(--bg-dark);
            border: none;
            padding: 1rem 2.5rem;
            font-size: 1rem;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
            transition: all 0.2s;
            letter-spacing: 1px;
            font-family: 'Rajdhani', sans-serif;
        }
        
        .btn:hover { background: #fff; box-shadow: 0 0 20px var(--primary); }
        .btn:disabled { background: var(--border); color: var(--text-dim); cursor: not-allowed; box-shadow: none; }
        .btn-outline { background: transparent; border: 1px solid var(--text-dim); color: var(--text-dim); }
        .btn-outline:hover { border-color: var(--text-main); color: var(--text-main); box-shadow: none; }

        .nav-footer { margin-top: 3rem; display: flex; justify-content: space-between; border-top: 1px solid var(--border); padding-top: 2rem; }

        /* --- Specific Views --- */
        /* Roster */
        .player-card { border-left: 3px solid var(--text-dim); }
        .player-card.role-carry { border-color: var(--accent); }
        .player-card.role-support { border-color: var(--primary); }
        .player-card.role-tank { border-color: var(--secondary); }

        /* Simulation */
        .terminal {
            background: #000;
            border: 1px solid var(--border);
            padding: 2rem;
            font-family: 'Roboto Mono', monospace;
            height: 300px;
            overflow-y: auto;
            color: var(--primary);
            font-size: 0.9rem;
            margin-bottom: 2rem;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
        }
        .log-entry { margin-bottom: 0.5rem; opacity: 0; animation: typeLine 0.3s forwards; }
        @keyframes typeLine { to { opacity: 1; } }
        .log-win { color: #00ff88; }
        .log-loss { color: var(--accent); }

        /* Ranges */
        input[type=range] { width: 100%; accent-color: var(--primary); margin: 1rem 0; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="logo">Esports<span>GM</span></div>
        <div class="hud">
            <div class="stat">
                <div class="stat-label">Budget</div>
                <div class="stat-value" id="hud-budget">$10k</div>
            </div>
            <div class="stat">
                <div class="stat-label">Team Skill</div>
                <div class="stat-value" id="hud-skill">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">Cohesion</div>
                <div class="stat-value" id="hud-cohesion">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">Burnout Risk</div>
                <div class="stat-value low" id="hud-risk">0%</div>
            </div>
        </div>
    </header>

    <section id="view-intro" class="fade-in">
        <h1>Season 3: The Rebuild</h1>
        <p>Welcome back, Coach. The board has cleared the roster. You have a fresh budget and a clean slate. Build a program that can win the championship without destroying the players' mental health.</p>
        <button class="btn" onclick="game.nextStep()">Initialize System</button>
    </section>

    <section id="view-recruitment" class="hidden fade-in">
        <div class="step-header">
            <h3>Step 1: Recruitment Pipeline</h3>
            <p>Select <strong>3</strong> channels to find talent. Each choices impacts your budget and the type of players you find.</p>
        </div>
        <div class="card-grid" id="recruitment-options">
            </div>
        <div class="nav-footer">
            <button class="btn btn-outline" disabled>Back</button>
            <button class="btn" id="btn-recruit-next" onclick="game.nextStep()" disabled>Confirm Strategy</button>
        </div>
    </section>

    <section id="view-training" class="hidden fade-in">
        <div class="step-header">
            <h3>Step 2: Training Framework</h3>
            <p>Balance intensity with wellness. High intensity boosts skill but increases burnout risk.</p>
        </div>
        
        <div style="margin-bottom: 2rem; background: var(--bg-panel); padding: 2rem; border-radius: 8px;">
            <label>Weekly Scrim Hours: <span id="val-hours" style="color:var(--primary)">20</span></label>
            <input type="range" min="10" max="60" value="20" step="5" oninput="game.updateTraining(this.value)">
            <p style="font-size: 0.8rem; margin-top: 0.5rem;">Impact: <span id="training-impact">Low Gains, Low Risk</span></p>
        </div>

        <div class="step-header">
            <h4>Focus Area</h4>
        </div>
        <div class="card-grid" id="training-focus">
            </div>

        <div class="nav-footer">
            <button class="btn btn-outline" onclick="game.prevStep()">Back</button>
            <button class="btn" onclick="game.nextStep()">Set Schedule</button>
        </div>
    </section>

    <section id="view-roster" class="hidden fade-in">
        <div class="step-header">
            <h3>Step 3: Final Roster</h3>
            <p>Based on your recruitment choices, these players attended tryouts. Select exactly <strong>5</strong> to sign.</p>
        </div>
        <div class="card-grid" id="roster-pool">
            </div>
        <div class="nav-footer">
            <button class="btn btn-outline" onclick="game.prevStep()">Back</button>
            <button class="btn" id="btn-roster-next" onclick="game.nextStep()" disabled>Sign Players</button>
        </div>
    </section>

    <section id="view-sim" class="hidden fade-in">
        <h3>Season Simulation</h3>
        <div class="terminal" id="sim-terminal">
            <div class="log-entry">> SYSTEM READY.</div>
            <div class="log-entry">> LOADING SEASON DATA...</div>
        </div>
        <div id="sim-results" class="hidden" style="text-align: center;">
            <h2 id="final-rank">RANK: 8th Place</h2>
            <p id="final-summary">The team struggled to find their footing.</p>
            <button class="btn" onclick="game.nextStep()">Proceed to Reflection</button>
        </div>
        <div class="nav-footer" id="sim-controls">
            <button class="btn btn-outline" onclick="game.prevStep()">Adjust Strategy</button>
            <button class="btn" onclick="game.runSimulation()">Start Season</button>
        </div>
    </section>

    <section id="view-reflection" class="hidden fade-in">
        <h3>Coach's Log</h3>
        <p>Reflect on the season outcomes to generate your report.</p>
        
        <div style="margin-bottom: 1.5rem;">
            <label style="display:block; margin-bottom:0.5rem;">1. What was the biggest factor in your result?</label>
            <textarea style="width:100%; height:100px; background:var(--bg-panel); color:white; border:1px solid var(--border); padding:1rem; border-radius:4px;"></textarea>
        </div>

        <div style="margin-bottom: 1.5rem;">
            <label style="display:block; margin-bottom:0.5rem;">2. What would you change in the recruitment phase?</label>
            <textarea style="width:100%; height:100px; background:var(--bg-panel); color:white; border:1px solid var(--border); padding:1rem; border-radius:4px;"></textarea>
        </div>

        <button class="btn" onclick="alert('Report Generated! (This would download a PDF in a real app)')">Export Report</button>
        <button class="btn btn-outline" onclick="location.reload()">New Season</button>
    </section>

</div>

<script>
const DB = {
    recruitment: [
        { id: 'social', title: 'Social Media Blitz', desc: 'High visibility, attracts flashy players.', cost: 2000, skillMod: 5, riskMod: 5 },
        { id: 'school', title: 'School Announcements', desc: 'Reliable, academic focused.', cost: 500, skillMod: 2, riskMod: -5 },
        { id: 'tourney', title: 'In-House Tournament', desc: 'Tests skill early.', cost: 3000, skillMod: 8, riskMod: 2 },
        { id: 'scout', title: 'Talent Scout', desc: 'Finds hidden gems.', cost: 4000, skillMod: 10, riskMod: 0 },
        { id: 'club', title: 'Club Collaboration', desc: 'Builds culture early.', cost: 500, skillMod: 3, riskMod: -10 }
    ],
    focus: [
        { id: 'mech', title: 'Mechanics', desc: 'Pure aim and reaction time.', skill: 10, cohesion: -5 },
        { id: 'vod', title: 'VOD Review', desc: 'Studying strategy.', skill: 5, cohesion: 5 },
        { id: 'bond', title: 'Team Bonding', desc: 'Mental health and trust.', skill: -2, cohesion: 12 }
    ],
    names: ['Viper', 'Chronos', 'Jinx', 'Neo', 'Frost', 'Ace', 'Ghost', 'Spark', 'Kilo', 'Luna']
};

class Game {
    constructor() {
        this.state = {
            step: 0,
            budget: 10000,
            skill: 40, // Base stat
            cohesion: 40, // Base stat
            risk: 10, // Base stat
            recruitment: [],
            trainingHours: 20,
            focus: null,
            roster: [],
            pool: []
        };
        this.steps = ['intro', 'recruitment', 'training', 'roster', 'sim', 'reflection'];
        this.init();
    }

    init() {
        this.renderRecruitment();
        this.renderFocus();
        this.updateHUD();
    }

    updateHUD() {
        document.getElementById('hud-budget').innerText = '$' + this.state.budget.toLocaleString();
        document.getElementById('hud-skill').innerText = Math.floor(this.state.skill);
        document.getElementById('hud-cohesion').innerText = Math.floor(this.state.cohesion);
        
        const riskEl = document.getElementById('hud-risk');
        riskEl.innerText = this.state.risk + '%';
        riskEl.className = 'stat-value ' + (this.state.risk > 70 ? 'low' : (this.state.risk > 40 ? 'med' : 'high'));
    }

    changeStep(direction) {
        const currentId = 'view-' + this.steps[this.state.step];
        document.getElementById(currentId).classList.add('hidden');
        
        this.state.step += direction;
        
        // Logic hooks between steps
        if (this.steps[this.state.step] === 'roster' && this.state.pool.length === 0) {
            this.generatePlayerPool();
        }

        const nextId = 'view-' + this.steps[this.state.step];
        document.getElementById(nextId).classList.remove('hidden');
    }

    nextStep() { this.changeStep(1); }
    prevStep() { this.changeStep(-1); }

    // --- Recruitment Logic ---
    renderRecruitment() {
        const container = document.getElementById('recruitment-options');
        container.innerHTML = DB.recruitment.map(opt => `
            <div class="option-card" onclick="game.toggleRecruit(this, '${opt.id}')">
                <div class="card-title">${opt.title}</div>
                <div class="card-desc">${opt.desc}</div>
                <div class="card-bonus">Cost: $${opt.cost}</div>
            </div>
        `).join('');
    }

    toggleRecruit(el, id) {
        const idx = this.state.recruitment.indexOf(id);
        const item = DB.recruitment.find(x => x.id === id);

        if (idx > -1) {
            this.state.recruitment.splice(idx, 1);
            el.classList.remove('selected');
            this.state.budget += item.cost;
            this.state.skill -= item.skillMod;
        } else {
            if (this.state.recruitment.length >= 3) return;
            if (this.state.budget < item.cost) { alert('Not enough budget!'); return; }
            this.state.recruitment.push(id);
            el.classList.add('selected');
            this.state.budget -= item.cost;
            this.state.skill += item.skillMod;
        }
        
        document.getElementById('btn-recruit-next').disabled = (this.state.recruitment.length !== 3);
        this.updateHUD();
    }

    // --- Training Logic ---
    updateTraining(val) {
        this.state.trainingHours = parseInt(val);
        document.getElementById('val-hours').innerText = val;
        
        let impactText = "";
        if (val < 30) { 
            this.state.risk = 10; 
            impactText = "Low Skill Gain, Minimal Burnout";
        } else if (val < 50) { 
            this.state.risk = 40; 
            impactText = "Moderate Skill Gain, Manageable Risk";
        } else { 
            this.state.risk = 80; 
            impactText = "Maximum Skill, HIGH Burnout Danger";
        }
        document.getElementById('training-impact').innerText = impactText;
        this.updateHUD();
    }

    renderFocus() {
        const container = document.getElementById('training-focus');
        container.innerHTML = DB.focus.map(opt => `
            <div class="option-card" onclick="game.selectFocus(this, '${opt.id}')">
                <div class="card-title">${opt.title}</div>
                <div class="card-desc">${opt.desc}</div>
            </div>
        `).join('');
    }

    selectFocus(el, id) {
        // Clear previous selection visuals
        document.querySelectorAll('#training-focus .option-card').forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
        
        // Revert previous bonus if exists
        if (this.state.focus) {
            const prev = DB.focus.find(x => x.id === this.state.focus);
            this.state.skill -= prev.skill;
            this.state.cohesion -= prev.cohesion;
        }

        this.state.focus = id;
        const current = DB.focus.find(x => x.id === id);
        this.state.skill += current.skill;
        this.state.cohesion += current.cohesion;
        this.updateHUD();
    }

    // --- Roster Logic ---
    generatePlayerPool() {
        const container = document.getElementById('roster-pool');
        container.innerHTML = '';
        
        // Generate 8 random players based on stats
        for(let i=0; i<8; i++) {
            const name = DB.names[Math.floor(Math.random() * DB.names.length)] + ' ' + (i+1);
            // Skill fluctuation based on team skill
            const pSkill = Math.floor(this.state.skill + (Math.random() * 20 - 10));
            const role = ['Carry', 'Support', 'Tank'][Math.floor(Math.random() * 3)];
            
            const player = { id: i, name, skill: pSkill, role };
            this.state.pool.push(player);

            container.innerHTML += `
                <div class="option-card player-card role-${role.toLowerCase()}" onclick="game.togglePlayer(this, ${i})">
                    <div class="card-title">${name}</div>
                    <div class="card-desc">${role} | Skill: ${pSkill}</div>
                </div>
            `;
        }
    }

    togglePlayer(el, id) {
        const idx = this.state.roster.indexOf(id);
        if (idx > -1) {
            this.state.roster.splice(idx, 1);
            el.classList.remove('selected');
        } else {
            if (this.state.roster.length >= 5) return;
            this.state.roster.push(id);
            el.classList.add('selected');
        }
        document.getElementById('btn-roster-next').disabled = (this.state.roster.length !== 5);
    }

    // --- Simulation ---
    async runSimulation() {
        document.getElementById('sim-controls').classList.add('hidden');
        const term = document.getElementById('sim-terminal');
        
        const log = (msg, type='') => {
            const div = document.createElement('div');
            div.className = 'log-entry ' + type;
            div.innerText = '> ' + msg;
            term.appendChild(div);
            term.scrollTop = term.scrollHeight;
        };

        // Calc Final Power
        const teamPower = this.state.skill + (this.state.cohesion * 0.5) - (this.state.risk * 0.5);
        let wins = 0;
        
        const delay = ms => new Promise(res => setTimeout(res, ms));

        await delay(800);
        log("SEASON STARTED...");
        
        for(let i=1; i<=5; i++) {
            await delay(1000);
            const enemyPower = 40 + (i * 10); // Harder each round
            const roll = Math.random() * 20;
            
            if (teamPower + roll > enemyPower) {
                wins++;
                log(`Week ${i} vs Rivals: VICTORY`, 'log-win');
            } else {
                log(`Week ${i} vs Rivals: DEFEAT`, 'log-loss');
                if (this.state.risk > 60 && Math.random() > 0.5) {
                    log(`  ! ALERT: Player burnout detected. Performance dropping.`, 'log-loss');
                    this.state.skill -= 5;
                }
            }
        }

        await delay(1000);
        log("SEASON COMPLETE. COMPILING DATA...");
        await delay(1000);

        document.getElementById('sim-results').classList.remove('hidden');
        const rankTitle = document.getElementById('final-rank');
        const summary = document.getElementById('final-summary');

        if (wins >= 4) {
            rankTitle.innerText = "RANK: CHAMPIONS";
            rankTitle.style.color = "#00ff88";
            summary.innerText = "An incredible performance. The dynasty begins.";
        } else if (wins >= 2) {
            rankTitle.innerText = "RANK: PLAYOFFS";
            rankTitle.style.color = "#ffd700";
            summary.innerText = "Solid season, but room for improvement.";
        } else {
            rankTitle.innerText = "RANK: ELIMINATED";
            rankTitle.style.color = "#ff0055";
            summary.innerText = "Disappointing results. The board is watching.";
        }
    }
}

const game = new Game();
</script>
</body>
</html>
